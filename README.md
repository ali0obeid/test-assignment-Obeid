# Тестовое задание на стажировку AppSecCloudCamp

На выполнение тестового задания у вас есть 7 дней. 
Выполненное задание следует опубликовать на GitHub и отправить на почту **appseccloudcamp@cloud.ru**. Практическое задание состоит из нескольких частей, при этом, даже если вы сделали только одну часть задания - присылайте её на рассмотрение. 
**ВАЖНО** При отправке тестового задания на почту обязательно указывайте ваши фамилию, имя, контактный номер телефон, telegram (при его наличии)

## 1. Вопросы для разогрева

1. Расскажите, с какими задачами в направлении безопасной разработки вы сталкивались?

   *В процессе моей работы я сталкивался с различными задачами в области безопасной разработки. Это включает в себя анализ кода на наличие уязвимостей, проведение аудитов безопасности, разработку и внедрение политик безопасности, а также обучение и поддержку команд в вопросах безопасности. Я также занимался моделированием угроз для определения потенциальных угроз и разработки стратегий их преодоления.*

2. Если вам приходилось проводить security code review или моделирование угроз, расскажите, как это было?

   *Проведение security code review и моделирование угроз требует глубокого понимания кода и потенциальным угрозам. В процессе security code review я анализировал код на наличие уязвимостей, таких как SQL-инъекции, XSS, CSRF и других. Это включало в себя поиск потенциальных мест, где злоумышленник мог бы внедрить вредоносный код или эксплуатировать уязвимости. Моделирование угроз, в свою очередь, помогало мне понять, какие атаки могут быть осуществлены против системы и как они могут быть предотвращены. Этот процесс включал в себя анализ потоков данных, идентификацию активов, агентов угроз и контролей для определения компонентов, которые могут быть целью атаки.*

3. Если у вас был опыт поиска уязвимостей, расскажите, как это было?

   *Поиск уязвимостей включает в себя систематический анализ кода и системы на предмет наличия потенциальных угроз. Это может включать в себя использование автоматизированных инструментов для сканирования кода, а также ручное тестирование для обнаружения уязвимостей, которые могут быть пропущены автоматизированными инструментами. Важно проводить этот анализ на разных этапах жизненного цикла разработки программного обеспечения, чтобы обнаружить и устранить уязвимости как можно раньше.*

4. Почему вы хотите участвовать в стажировке?
   
   *Я хочу участвовать в стажировке, потому что это прекрасная возможность для профессионального роста и развития моих навыков в области безопасности. Я стремлюсь к тому, чтобы стать экспертом в области безопасности и внести свой вклад в создание безопасных систем и приложений. Участие в стажировке позволит мне приобрести практический опыт, изучить новейшие технологии и методы в области безопасности, а также получить ценные знания и навыки от опытных специалистов в этой области.*

---

## 2. Security code review

### Часть 1. Security code review: GO

Требуется провести анализ кода на GO с точки зрения безопасности и подготовить отчет по следующим пунктам:
 - Какие уязвимости присутствуют в этом фрагменте кода?
 
   *SQL Injection: В строке, где формируется SQL-запрос, используется fmt.Sprintf для вставки значения searchQuery напрямую в запрос. Это может привести к SQL-инъекции, если searchQuery содержит злонамеренный код.*
 - Указать строки, в которых присутствуют уязвимости.
   ```
   query := fmt.Sprintf("SELECT * FROM products WHERE name LIKE '%%%s%%'", searchQuery)
   ```
 - К каким последствиям может привести эксплуатация найденных уязвимостей злоумышленником?

   *Злоумышленник может получить доступ к любым данным в базе данных, изменить или удалить их.*
 - Описать способы исправления уязвимостей.

   *Использовать параметризованные запросы или подготовленные выражения для безопасной вставки данных в SQL-запрос.*
 - Если уязвимость можно исправить несколькими способами, необходимо перечислить их, выбрать лучший по вашему мнению и аргументировать свой выбор.
 
   *Использование параметризованных запросов. Это наиболее эффективный способ предотвращения SQL-инъекций, поскольку он автоматически обрабатывает ввод пользователя, предотвращая его интерпретацию как часть SQL-запроса.*

```
package main

import (
    "database/sql"
    "fmt"
    "log"
    "net/http"
    "github.com/go-sql-driver/mysql"
)

var db *sql.DB
var err error

func initDB() {
    db, err = sql.Open("mysql", "user:password@/dbname")
    if err != nil {
        log.Fatal(err)
    }

err = db.Ping()
if err != nil {
    log.Fatal(err)
    }
}

func searchHandler(w http.ResponseWriter, r *http.Request) {
    if r.Method != "GET" {
        http.Error(w, "Method is not supported.", http.StatusNotFound)
        return
    }

searchQuery := r.URL.Query().Get("query")
if searchQuery == "" {
    http.Error(w, "Query parameter is missing", http.StatusBadRequest)
    return
}

query := fmt.Sprintf("SELECT * FROM products WHERE name LIKE '%%%s%%'", searchQuery)
rows, err := db.Query(query)
if err != nil {
    http.Error(w, "Query failed", http.StatusInternalServerError)
    log.Println(err)
    return
}
defer rows.Close()

var products []string
for rows.Next() {
    var name string
    err := rows.Scan(&name)
    if err != nil {
        log.Fatal(err)
    }
    products = append(products, name)
}

fmt.Fprintf(w, "Found products: %v\n", products)
}

func main() {
    initDB()
    defer db.Close()

http.HandleFunc("/search", searchHandler)
fmt.Println("Server is running")
log.Fatal(http.ListenAndServe(":8080", nil))
}
```

### Часть 2: Security code review: Python

**Пример 2.1**
Требуется определить тип уязвимости в примерах кода на Python и ответить на следующие вопросы:
 - Указать строки, в которых присутствуют уязвимости.
    ```
   output = Template('Hello ' + name + '! Your age is ' + age + '.').render()
   ```
   *XSS (Cross-Site Scripting): В строке, где формируется вывод, значения `name` и `age` вставляются напрямую в HTML без какой-либо очистки или экранирования. Это может привести к XSS-атакам.*
 - К каким последствиям может привести эксплуатация данных уязвимостей злоумышленником?

   *Злоумышленник может выполнить произвольный JavaScript-код в браузере пользователя, что может привести к краже данных, выполнению действий от имени пользователя или другим вредоносным действиям.*
 - Описать способы исправления уязвимостей.

   *Использовать функции экранирования или шаблонизации, которые автоматически обрабатывают ввод пользователя, предотвращая его интерпретацию как часть HTML или JavaScript.*
 - Если уязвимость можно исправить несколькими способами, необходимо перечислить их, выбрать лучший по вашему мнению и аргументировать свой выбор.
 
   *Лучший способ исправления:
Использование функций экранирования или шаблонизации, предоставляемых фреймворком Flask, для безопасной вставки данных в HTML.*

**Пример кода №2.1**
```
from flask import Flask, request
from jinja2 import Template

app = Flask(name)

@app.route("/page")
def page():
    name = request.values.get('name')
    age = request.values.get('age', 'unknown')
    output = Template('Hello ' + name + '! Your age is ' + age + '.').render()
return output

if name == "main":
    app.run(debug=True)
```
**Пример 2.2**

Требуется определить тип уязвимости в примерах кода на Python и ответить на следующие вопросы:
 - Указать строки, в которых присутствуют уязвимости.

   ```
   cmd = 'nslookup ' + hostname
   ```
   *OS Command Injection: В строке, где формируется команда для выполнения, значение `hostname` вставляется напрямую в команду без какой-либо очистки или экранирования. Это может привести к выполнению произвольных команд операционной системы.*
 - К каким последствиям может привести эксплуатация данных уязвимостей злоумышленником?

   *Последствия эксплуатации:
   Злоумышленник может выполнить произвольные команды на сервере, что может привести к несанкционированному доступу к данным, выполнению вредоносных действий или другим вредоносным действиям.*
 - Описать способы исправления уязвимостей.
 
   *Использовать функции экранирования или валидации, которые проверяют ввод пользователя на наличие потенциально опасных символов или команд.*   
 - Если уязвимость можно исправить несколькими способами, необходимо перечислить их, выбрать лучший по вашему мнению и аргументировать свой выбор.

   *Использование функций экранирования или валидации, предоставляемых фреймворком Flask или Python, для безопасной вставки данных в команды.*


**Пример №2.2**
```
from flask import Flask, request
import subprocess

app = Flask(name)

@app.route("/dns")
def dns_lookup():
    hostname = request.values.get('hostname')
    cmd = 'nslookup ' + hostname
    output = subprocess.check_output(cmd, shell=True, text=True)
return output
if name == "main":
    app.run(debug=True)
```

## 3. Моделировани угроз

Изучите диаграмму потоков данных (Data Flow Diagram, DFD) сервиса, обеспечивающего отправку информации в Telegram и Slack:

![DFD](https://github.com/appseccloudcamp/test-assignment/blob/main/test-dfd.png)

Краткое описание компонентов сервиса:
 - **User** - авторизованный пользователь системы. Может настраивать отправку уведомлений и загружать изображения для дальнейшего использования при отправке уведомлений;
 - **Microfront** - микрофронт, которые позволяет взаимодействовать с сервисом отправки информации;
 - **Backend application** - набор микросервисов реализующих бизнес-логику приложения и обеспечивающих взаимодействие со всеми внешними сервисами;
 - **Auth** - сервис отвечающий за аутентификацию и авторизацию клиентов сервиса отправки информации;
 - **S3** - объектное хранилище, предназначенное для хранения статического контента сервиса отправки информации;
 - **PostgreSQL** - база данных, предназначенная для хранения пользовательских конфигураций сервиса отправки информации.    

Проанализируйте диаграмму потоков данных приложения и ответьте на следующий вопросы:
 - Расскажите, какие потенциальные проблемы безопасности существуют для данного сервиса?
    - *Недостаточная аутентификация и авторизация.*
    - *Незащищенное хранение данных в S3 и PostgreSQL.*
    - *Отсутствие шифрования данных при передаче.*
 - Расскажите, к каким последствиям может привести эксплуатация проблем, найденных вами?
    - *Последствия эксплуатации:*
      - *Утечка конфиденциальной информации.*
      - *Несанкционированный доступ к сервису.*
      - *Компрометация данных пользователей.*
 - Расскажите, какие способы исправления уязвимостей и смягчения рисков вы можете предложить по отмеченным вами проблемам безопасности
     - *способы исправления:*
        - *Использование HTTPS для защищенной передачи данных.*
        - *Применение шифрования данных как в хранении, так и при передаче.*
        - *Усиление мер аутентификации и авторизации.*
 - Напишите список уточняющих вопросов, которые вы бы задали разработчикам данного сервиса?
     - *Список уточняющих вопросов:*
        - *Какие меры безопасности уже применяются в сервисе?*
        - *Как обеспечивается шифрование данных при передаче?*
        - *Какие меры принимаются для защиты данных в S3 и PostgreSQL?*
